# Advanced LLM Telegram Bot

Этот Telegram-бот для подготовки к экзаменам с интеграцией LangChain и Ollama для генерации ответов, конспектов, заданий и квизов. Бот включает дополнительные возможности, такие как:
- **Документная обработка:** Принимает файлы (PDF, DOCX, TXT, JPEG, PNG) и извлекает из них текст.
- **Генерация конспектов:** Создаёт краткий конспект материала и рекомендации для улучшения обучения.
- **Генерация заданий:** Генерирует задание по загруженному материалу.
- **Генерация квизов:** При выборе команды «Квиз» бот генерирует квиз-сессию из 10 вопросов. После исчерпания вопросов сеанс завершается, и для новой партии вопросов необходимо заново нажать кнопку «Квиз».
- **Ответы на вопросы:** Любой текст, не совпадающий с командами, считается вопросом по материалу – бот генерирует ответ.
- **Память:** Сохраняет загруженный материал и историю запросов как в оперативной памяти (через словарь `user_data`), так и в виде файлов.
- **Callback-функциональность:** Inline-клавиатура для квиза (с кнопкой «Следующий квиз») позволяет переключаться между вопросами.
- **Фильтрация:** При обнаружении запрещённых слов (например, «badword1») бот уведомляет администратора через Telegram.

## Требования

- Python 3.9+
- Telegram Bot Token (получается через [BotFather](https://t.me/BotFather))
- Telegram Admin Chat ID (для уведомлений)

## Установка

1. **Клонируйте репозиторий:**
   ```bash
   git clone https://github.com/yourusername/advanced-llm-telegram-bot.git
   cd advanced-llm-telegram-bot
   ```

2. **Создайте и активируйте виртуальное окружение:**
   ```bash
   python3 -m venv venv
   source venv/bin/activate   # на Windows: venv\Scripts\activate
   ```

3. **Установите зависимости:**
   ```bash
   pip install -r requirements.txt
   ```

4. **Настройте переменные окружения:**
   Либо отредактируйте файл `main.py`, заменив строки с `YOUR_TELEGRAM_BOT_TOKEN` и `YOUR_ADMIN_CHAT_ID` на реальные значения, либо создайте файл `.env`.

5. **Установите Tesseract:**
   - **Ubuntu:**
     ```bash
     sudo apt update && sudo apt install tesseract-ocr
     ```
   - **macOS:**
     ```bash
     brew install tesseract
     ```
   - **Windows:**  
     Скачайте и установите Tesseract с [официального репозитория](https://github.com/tesseract-ocr/tesseract).

## Запуск

Запустите бота командой:
```bash
python main.py
```

## Как работает бот

1. **Старт:**  
   Отправьте команду `/start` в Telegram. Бот пришлёт инструкцию и главное меню (reply-клавиатура).

2. **Загрузка документа:**  
   Отправьте документ (PDF, DOCX, TXT, JPEG, PNG). Бот извлечёт текст и сохранит его.

3. **Конспект:**  
   Нажмите кнопку **Конспект** – бот сгенерирует краткий конспект материала и рекомендации, выводя их по частям.

4. **Задача:**  
   Нажмите кнопку **Задача** – бот сгенерирует задание по материалу.

5. **Квиз:**  
   - Нажмите кнопку **Квиз** – бот сгенерирует новую квиз-сессию из 10 вопросов и сохранит их.
   - Первый вопрос будет отправлен как опрос (poll) с inline-клавиатурой.
   - При нажатии кнопки **Следующий квиз** бот выдаст следующий вопрос из сохранённой сессии.
   - После 10 вопросов квиз-сессия завершается.

6. **Задать вопрос:**  
   Отправьте текст, не совпадающий с командами – бот считает его вопросом и выдаёт ответ, используя загруженный материал.

7. **Материал:**  
   Нажмите **Материал** – бот покажет инструкцию для загрузки документа.

8. **Стоп:**  
   Нажмите **Стоп** для отмены текущей операции.

## Возможные улучшения

- Интеграция с базой данных для долговременного хранения истории и материалов.
- Расширение функционала цепочек LangChain для многошагового рассуждения.
- Улучшение логирования и обработки ошибок.
- Возможность переключения между локальным LLM и удалённым API вызовом для оптимизации скорости.
